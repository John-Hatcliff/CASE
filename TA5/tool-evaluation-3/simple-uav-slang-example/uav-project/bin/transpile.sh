#!/usr/bin/env bash
#
# This file is autogenerated.  Do not edit
#
set -e
export SCRIPT_HOME=$( cd "$( dirname "$0" )" &> /dev/null && pwd )
export PROJ_HOME=$SCRIPT_HOME/../src/main
export OUTPUT_DIR=$SCRIPT_HOME/../src/c
export EXTS=$OUTPUT_DIR/ext/ext.c:$OUTPUT_DIR/ext/ipc.h:$OUTPUT_DIR/ext/ipc.c

if [ -n "$1" ]; then
  TRANSPILER_JAR_HOME=$1
fi

if [ -z "$TRANSPILER_JAR_HOME" ]; then
  echo "Specify the location of the Sireum-Transpiler jar file"
  exit 1
fi

$TRANSPILER_JAR_HOME slang transpilers c \
  --sourcepath $PROJ_HOME \
  --apps "ACT_Demo_Dec2018__camkes_X.UART_Impl_App,ACT_Demo_Dec2018__camkes_X.WaypointManager_Impl_App,ACT_Demo_Dec2018__camkes_X.Radio_Impl_App,ACT_Demo_Dec2018__camkes_X.FlightPlanner_Impl_App,ACT_Demo_Dec2018__camkes_X.UARTDriver_Impl_App,ACT_Demo_Dec2018__camkes_X.RadioDriver_Impl_App,ACT_Demo_Dec2018__camkes_X.Main" \
  --forward "art.ArtNative=ACT_Demo_Dec2018__camkes_X.ArtNix,ACT_Demo_Dec2018__camkes_X.Platform=ACT_Demo_Dec2018__camkes_X.PlatformNix" \
  --verbose \
  --bits 32 \
  --string-size 256 \
  --sequence-size 24 \
  --sequence ISZ[org.sireumString]=2 \
  --output-dir $OUTPUT_DIR \
  --exts $EXTS
